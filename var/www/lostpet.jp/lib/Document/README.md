# Document
- ユーザーのリクエストを処理して文書を作成する。

## 種類
下記の4種類を取り扱う。

### http
- クライアントは、HTTP遷移でアクセスし、HTML文書を取得する。

### ajax
- クライアントは、`fetch()`でアクセスし、JSON文書を取得する。
- クライアントは、Cookie付きの`fetch()`でアクセスし、JSON文書を取得する。

### cli
- クライアントは、cliでアクセスし、ログ文書を取得する。
- 主にcronで利用する。



## 手順
大まかに3つの手順に分ける。

### 解析
- リクエストには必ず、URLが付与される。
- リクエスト(URL)を解析して該当のファイルを読み込む。

### 処理
- 読み込まれたファイルが、そのまま処理を実行する。
- 出力するHTML、またはJSONを作成する。

### 出力
- 作成されたHTML、JSONを出力する。

## エラー
例外エラーが発生した場合、`error()`を呼び出す。  
安全、安定のために下記のルールを守る。

- **フォローバックしない**  
ログを残して、処理の継続を諦める。

- **アプリを強制停止する**  
クライアントにはエラー画面を表示して、それ以降の操作を受け付けず、再度httpアクセスを要求する。

| コード | 説明 |
| -- | -- |
| 400 | クライアント側が原因のエラー。 |
| 500 | サーバー側が原因のエラー。 |
| 503 | メンテナンス中。 |

